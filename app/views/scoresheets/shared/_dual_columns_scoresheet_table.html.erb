<table style="width:100%; border-collapse:collapse; margin-bottom:24px;">
    <thead>
      <tr>
        <th style="border-bottom:1px solid #ccc; padding:8px; width:40px; text-align:center;">Round</th>
        <% scoresheet.game_session.session_players.each do |session_player| %>
          <th style="border-bottom:1px solid #ccc; padding:8px; text-align:center;" colspan="2">
            <%= session_player.display_name %>
          </th>
        <% end %>
      </tr>
      <tr>
        <th></th>
        <% scoresheet.game_session.session_players.each_with_index do |session_player, idx| %>
          <th style="border-bottom:1px solid #eee; border-right:1px solid #ddd; padding:4px; text-align:center; font-size:12px; color:#888; width:40px;">Bid</th>
          <th style="border-bottom:1px solid #eee; padding:4px; text-align:center; font-size:12px; color:#888; width:60px;<% if idx < @scoresheet.game_session.session_players.size - 1 %> border-right:3px solid #888;<% end %>">Score</th>
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% scoresheet.rounds.order(:round_number).each do |round| %>
          <tr
            <% if editable_cell?(round) %>
              <%=tag.attributes(scoresheet_row_attributes(scoresheet, round))%>
              class="hover:bg-blue-100 transition cursor-pointer"
            <% end %>
          >
          <td style="border-right:1px solid #eee; padding:8px; width:40px; text-align:center; font-weight:bold;">
            <%= round.round_number %>
          </td>
            <% scoresheet.game_session.session_players.each_with_index do |session_player, idx| %>
              <% cell_types.each do |cell_type| %>
                <% bid = round.data['bids']&.[](session_player.display_name) || 0 %>
                <% tricks = round.data['tricks']&.[](session_player.display_name) || 0 %>
                <td
                  style="<%= cell_style_helper.call(cell_type, bid, tricks) %>"
                  <%= tag.attributes(scoresheet_cell_attributes(round, session_player, controller_name, cell_type)) %>
                >
                  <%= round.data.dig("#{cell_type}s", session_player.display_name) %>
                </td>
              <% end %>
            <% end %>
        </tr>
      <% end %>
    </tbody>
    <tfoot>
      <tr>
        <td style="font-weight:bold;">Total</td>
        <% scoresheet.game_session.session_players.each_with_index do |session_player, idx| %>
          <td></td>
          <td style="font-weight:bold; font-size:18px; color:#6d28d9;<% if idx < scoresheet.game_session.session_players.size - 1 %> border-right:3px solid #888;<% end %>">
            <%= @scoresheet.rounds.sum { |round| round.data.dig("scores", session_player.display_name).to_i } %>
          </td>
        <% end %>
      </tr>
    </tfoot>
  </table>
